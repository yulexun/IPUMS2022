---
title: "TODO"
subtitle: "TODO"
date: today
date-format: long
abstract: "TODO"
format: pdf
number-sections: true
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(janitor)
library(knitr)
```



```{r}
#| include: false
#| warning: false
#| message: false

acs_2022 <- read_csv("../data/raw/usa_00001 3.csv") %>% clean_names()
# head(us_yearly_survey)

```

# Question 1

## How many respondents were there in each state (STATEICP) that had a doctoral degree as their highest educational attainment (EDUC)?

```{r}

# table, stateICP, number of doctors

doctor_prop_table <- us_yearly_survey %>% 
  select(STATEICP, EDUCD) %>% filter(!is.na(STATEICP) & !is.na(EDUCD)) %>% 
  group_by(STATEICP) %>% 
  summarise(number_of_respondents = n(), 
            number_of_doctors = sum(EDUCD == 116),
            doctor_proportion = number_of_doctors / number_of_respondents)


doctor_prop_table %>% kable(col.names = 
                              c("State ICP", 
                                "Respondent Count", 
                                "Doctor Count", "Doctor Proportion"))

```

## Laplace to estimator. Given 391,171 California Respondents use estimator to find number of participants for all states.

```{r}

# california is 71# 391,171 from table and from the quercus directions

# reducing data for estimator question purposes
cali_resp_count <- 391171
state_doctors_count <- doctor_prop_table %>% select(STATEICP, number_of_doctors)

california_doctor_prop <- as.numeric((state_doctors_count %>% filter(STATEICP == 71) %>% 
  select(number_of_doctors)) / cali_resp_count)

number_of_respondents_estimate <- state_doctors_count %>% mutate(
  estimate_respondent_count = round(number_of_doctors / california_doctor_prop)
)

number_of_respondents_estimate %>% kable(col.names = 
                                           c("State ICP", "Doctor Count", 
                                             "Estimated Respondent Count"))


```

### Different between estimator and non estimator


```{r}

number_of_respondents_estimate %>% 
  select(STATEICP, estimate_respondent_count) %>%
  inner_join(doctor_prop_table, by = "STATEICP") %>%
  select(STATEICP, estimate_respondent_count, number_of_respondents) %>% 
  mutate(difference = estimate_respondent_count - number_of_respondents) %>% 
  kable(col.names = c("State ICP", "Estimated Respondent Count", 
                      "Respondent Count",
                      "Difference"))

```



